modules = ["nodejs-20", "web", "ruby-3.2"]
run = "cd backend && chmod +x setup-replit.sh && ./setup-replit.sh && npm start\""

[nix]
channel = "stable-24_05"

# Main run command - starts the backend server
run = "cd backend && chmod +x setup-replit.sh && ./setup-replit.sh && npm start"

# Development commands
[deployment]
run = ["sh", "-c", "cd backend && npm install && npm start"]
deploymentTarget = "cloudrun"

[[ports]]
localPort = 3001
externalPort = 80
name = "main"

[[ports]]
localPort = 3000
externalPort = 3000
name = "frontend"

# Environment setup
[env]
NODE_ENV = "production"
PORT = "3001"

# File watching and hot reload
[languages]

[languages.javascript]
pattern = "**/{*.js,*.jsx,*.ts,*.tsx,*.json}"

[languages.javascript.languageServer]
start = "typescript-language-server --stdio"

# Package management
[packager]
language = "nodejs"

[packager.features]
packageSearch = true
guessImports = true
enabledForHosting = false

# Git configuration
[gitHubImport]
requiredFiles = [".replit", "replit.nix"]

# Web hosting
[hosting]
route = "/"
directory= "frontend/build"